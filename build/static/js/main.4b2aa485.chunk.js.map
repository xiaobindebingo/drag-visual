{"version":3,"sources":["components/Group/index.module.scss","views/Editor/index.module.scss","views/Editor/Element/ResizeWrapper/Circle/index.module.scss","views/AttributePanel/index.module.scss","views/Editor/MarkLine/index.module.scss","store/record.ts","store/reducers.ts","store/actionType.ts","store/index.ts","components/Alert/Alert.tsx","components/Group/index.tsx","resourceCenter/componentHash.ts","constants/index.ts","resourceCenter/componentStore.tsx","utils.ts","store/actions.ts","views/Header/index.tsx","views/ComponentPanel/index.tsx","views/Editor/GridLine/index.tsx","views/Editor/Element/ResizeWrapper/Circle/index.tsx","views/Editor/Element/ResizeWrapper/Rotate/index.tsx","views/Editor/Element/ResizeWrapper/constants.ts","views/Editor/Element/ResizeWrapper/index.tsx","views/Editor/Element/index.tsx","views/Editor/MarkLine/index.tsx","views/Editor/Area/index.tsx","views/Editor/index.tsx","views/AttributePanel/index.tsx","views/Preview/index.tsx","index.tsx","views/Header/index.module.scss","views/ComponentPanel/index.module.scss","views/Editor/Element/ResizeWrapper/index.module.scss","index.module.css"],"names":["module","exports","list","index","maxLength","curIndex","this","record","push","length","shift","console","log","componentMap","previewVisible","canvasWidth","canvasHeight","scale","selectComponentId","containIds","areaPos","startPos","left","top","endPos","reducer","state","action","type","payload","id","locked","isLocked","containerProps","style","addRecord","getPrevRecord","getNextRecord","store","createStore","reducers","window","__REDUX_DEVTOOLS_EXTENSION__","Alert","props","useState","open","setOpen","className","alertType","children","title","klass","ss","closeble","onClick","defaultProps","Group","styles","group","componentHash","hash","register","key","val","getHash","GROUP","config","icon","text","initialProps","width","height","changeState","newVal","Object","prototype","toString","call","Array","isArray","reduce","prev","cur","getClientPosByEvent","e","x","clientX","y","clientY","getElementPosByEvent","nativeEvent","offsetX","offsetY","getElementByType","Component","ComponentStore","pxToPercent","percentToPx","percent","match","absoluteToRealtiveCoordinate","innterPropsStyle","containerBox","otherStyle","realtiveToAbsoluteCoordinate","Math","ceil","plainDatatoTree","uuids","keys","copyComponentMap","cloneDeep","forEach","parentId","cancelRecords","updateCurContainerStyleAction","connect","model","dispatch","changeWidth","changeHeight","changeScale","updateState","step","redoRecords","addRecords","toggleLock","boxInfo","min","abs","speed","setSpeed","header","display","marginRight","max","hasTip","value","onChange","Number","playback","item","setTimeout","numberPicker","marginLeft","disabled","uuid","combineMap","includes","getCombineComponentMap","newState","selectId","splitMap","JSON","stringify","componentList","map","component","cell","draggable","onDragStart","dataTransfer","setData","src","GridLine","show","xmlns","patternUnits","d","fill","stroke","strokeWidth","Circle","position","role","tabIndex","onMouseDown","preventDefault","stopPropagation","startX","startY","move","moveEvent","curX","curY","distanceX","distanceY","updateComponentItemByPos","document","addEventListener","up","removeEventListener","circle","Rotate","fillRule","circleProps","cursor","right","marginTop","bottom","updateCurContainerStyle","updateSelectComponentAndOrderMap","wrapper","useRef","current","offsetWidth","offsetHeight","offsetLeft","offsetTop","isSelected","updateProps","newPropsByPos","lt","round","rt","lb","br","t","l","r","b","rotate","centerX","centerY","ref","cls","selected","zIndex","transform","orderMap","copyObj","updateComponentMapOrder","currentTarget","onDragOver","startRotate","PI","atan2","endRotate","circleProp","size","componentProps","initlineArr","lineArr","setLineArr","isNearly","dragVal","targetVal","updateLineArr","curTop","curLeft","curBottom","curRight","curWidth","curHeight","getCurrentComponentsPosition","hideLine","useDeepCompareEffect","centerPos","curCenterPos","useEffect","markline","hide","hor","ver","line","boxLeft","boxTop","border","updateComponentMap","updateSelectComponent","updateAreaPos","updateComponentMapAndSelectId","showGridLine","toggleGridLine","scaleRatio","initialAreaPos","deleteElement","copyState","selectedId","filter","angleToRadian","angle","calculateRotatedPointCoordinate","center","point","cos","sin","transferData","editor","transformOrigin","handleKeys","onKeyEvent","backspace","querySelector","getBoundingClientRect","componentinfo","minWrapperPos","startLeft","MAX_SAFE_INTEGER","endLeft","startTop","endTop","getRotatePointByPoint","curry","leftTopX","leftTopY","rightTopX","rightTopY","leftBottomX","leftBottomY","rightBottomX","rightBottomY","maxX","minX","maxY","minY","getMinWrapperAreaPos","onDrop","getData","updatedMap","renderElement","data","uid","attributePanel","closeDialog","visible","onClose","onCancel","onOk","Parent","container","content","ReactDOM","render","getElementById","stats","Stats","showPanel","body","appendChild","dom","requestAnimationFrame","animate","begin","end"],"mappings":"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","file":"static/js/main.4b2aa485.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"group\":\"Group_group__KDQxi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"editor\":\"Editor_editor__vzXVZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"circle\":\"Circle_circle__18Nbv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"attributePanel\":\"AttributePanel_attributePanel__3OHup\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"markline\":\"MarkLine_markline__bJ0QZ\",\"line\":\"MarkLine_line__3GMwM\",\"hor\":\"MarkLine_hor__32M3f\",\"ver\":\"MarkLine_ver__3WRU8\",\"hide\":\"MarkLine_hide__1ShMr\"};","export const initialState = {\n  componentMap: {},\n  previewVisible: false,\n  canvasWidth: 1200,\n  canvasHeight: 750,\n  scale: 100,\n  selectComponentId: \"\",\n  containIds: [],\n  areaPos: {\n    startPos: {\n      left: 0,\n      top: 0,\n    },\n    endPos: {\n      left: 0,\n      top: 0,\n    },\n  },\n};\n\nclass Record {\n  public list: any[];\n  public maxLength: number;\n  public curIndex: number;\n  constructor(list, index, maxLength?) {\n    this.list = list;\n    this.curIndex = index;\n    this.maxLength = maxLength || 20;\n  }\n  \n  addRecord(record) {\n    this.list.push(record);\n    if(this.list.length > this.maxLength) {\n      this.list.shift();\n    }\n    this.curIndex = this.list.length - 1;\n  }\n  getPrevRecord() {\n    this.curIndex = this.curIndex > 0 ? this.curIndex - 1 : this.curIndex;\n    console.log(  this.curIndex, this.list)\n    return this.list[this.curIndex];\n  } \n\n  getNextRecord() {\n    if(this.curIndex + 1 >= this.list.length -1) {\n      this.curIndex = this.list.length -1\n    } else {\n      this.curIndex += 1;\n    }\n\n    return this.list[this.curIndex];\n  }\n\n}\n\nexport default new Record([initialState], 0, 100);\n\n","import * as actionTypes from \"./actionType\";\nimport record from \"./record\";\n\nfunction reducer(state = record.list[0], action) {\n\n  if (action.type === actionTypes.SAVE) {\n    return {\n      ...state,\n      ...action.payload,\n    };\n  }\n\n  if (action.type === actionTypes.TOGGLE_LOCK) {\n    const { id, locked } = action.payload;\n    console.log(id, locked,'locke')\n    return {\n      ...state,\n      componentMap: {\n        ...state.componentMap,\n        [id]: {\n          ...state.componentMap[id],\n          isLocked: locked,\n        }\n      }\n    }\n  }\n  \n  // 更新componentContainerStyle属性\n  if (action.type === actionTypes.UPDATE_CURCONTAINER_STYLE) {\n    const { payload } = action;\n    const { selectComponentId: id } = state;\n    return {\n      ...state,\n      componentMap: {\n        ...state.componentMap,\n        [id]: {\n          ...state.componentMap[id],\n          containerProps: {\n            ...state.componentMap[id][\"containerProps\"],\n            style: {\n              ...state.componentMap[id][\"containerProps\"][\"style\"],\n              ...payload,\n            },\n          },\n        },\n      },\n    };\n  }\n\n  if (action.type === actionTypes.SAVE_RECORDS) {\n    record.addRecord(state);\n    return state;\n  }\n\n  if (action.type === actionTypes.CANCEL_RECORDS) {\n    return  record.getPrevRecord();\n  }\n\n  if (action.type === actionTypes.REDO) {\n    return record.getNextRecord();\n  }\n\n\n  return state;\n}\n\nexport default reducer;\n","export const SAVE_RECORDS: string = 'saveRecords';\n\nexport const CANCEL_RECORDS: string = 'cancleRecords';\n\nexport const REDO: string = 'redo';\n\nexport const SAVE: string = 'save';\nexport const UPDATE_COMPOMENTMAP = 'updateComponentMap';\n\nexport const  UPDATE_CURCONTAINER_STYLE= 'updateCurContainerStyle';\n\nexport const TOGGLE_LOCK = 'toggleLock';","import { createStore } from 'redux';\nimport reducers from './reducers';\n\nlet store = createStore(reducers,\n  (window as any).__REDUX_DEVTOOLS_EXTENSION__ &&\n  (window as any).__REDUX_DEVTOOLS_EXTENSION__());\n\nexport default store;\n\n\nconst pointer = {\n  '0-30': 'n-resize',\n  '30-60': 'ne-resize',\n  '60-120': 'w-resize',\n  '120-150': 'nw-resize',\n  '150-210': 'n-resize',\n  '210-240': 'ne-resize',\n  '240-300': 'e-resize',\n  '301-330': 'se-resize',\n  '330-359': 's-resize'\n}","import React, { useState } from 'react';\nimport ss from 'classnames';\nimport './alert.scss';\nexport type AlertType = 'success'|'danger'|'warning'|'default'\ninterface baseAlertProps{\n    className?: string,\n    alertType?: AlertType,\n    children: React.ReactNode,\n    title: React.ReactNode,\n    closeble: Boolean,\n}\nexport type AlertProps =  Partial<baseAlertProps & React.HTMLAttributes<HTMLElement>>;\nconst Alert: any = (props)=>{\n    const [open, setOpen] = useState<Boolean>(true);\n    const {className, alertType ,children, title} = props;\n    const klass = ss('alert', className, {\n        [`alert-${alertType}`]: alertType,\n        \n    })\n    return ( open ? <div className={klass}>\n        <div className=\"alert-message\">{title} { props.closeble && <span className=\"alert-close\" onClick={()=>setOpen(false)}>关闭</span>}</div>\n            <div className='alert-content'>{children}</div>\n            </div> : null)\n}\nAlert.defaultProps = {\n    alertType: 'default',\n    \n}\nexport { Alert }\nexport default Alert;","import React from 'react';\nimport styles from './index.module.scss';\n\nfunction Group(props) {\n  return (\n    <div\n      className={styles.group}\n    >\n      {props.children}\n    </div>\n  )\n}\n\nexport default Group;\n","const componentHash = () => {\n  const hash = {};\n  return {\n    register: (key, val) => {\n      hash[key] = val;\n    },\n    getHash: (key?) => {\n      if(!key) return hash;\n      return hash[key];\n    }\n  }\n}\n\nexport default componentHash();","export const GROUP = 'group';","import Alert from '../components/Alert/Alert';\nimport Group from '../components/Group';\nimport hash from './componentHash';\nimport { GROUP } from '../constants';\n\nAlert.config = {\n  icon: 'https://img.alicdn.com/tfs/TB1i4enT4v1gK0jSZFFXXb0sXXa-32-32.svg',\n  text: '弹窗',\n};\n\nAlert.initialProps = {\n   width: 200,\n   height: 100,\n   type: 'danger',\n   title: 'dangerTitle',\n   children: '哈哈'\n}\n\nhash.register('alert', Alert);\nhash.register(GROUP, Group);// group初始化一个组件\n\nexport default hash.getHash();","import ComponentStore from \"./resourceCenter/componentStore\";\nimport cloneDeep from 'lodash/cloneDeep';\n\nexport function changeState(key, newVal?) {\n\n  if (Object.prototype.toString.call(key) === \"[object Object]\") {\n    return {\n      type: 'save',\n      payload: key,\n    }\n  }\n  if (Array.isArray(key)) {\n    const payload = key.reduce((prev ,cur)=>{\n      return {\n        ...prev,\n        ...cur,\n      }\n    }, {});\n\n    return {\n      type: 'save',\n      payload,\n    }\n  }\n  return {\n    type: 'save',\n    payload: {[key]: newVal}\n  }\n}\n\n\nexport function getClientPosByEvent(e:MouseEvent) {\n  return {\n    x: e.clientX,\n    y: e.clientY,\n  }\n}\n\nexport function getElementPosByEvent(e: React.DragEvent) {\n  return {\n    left: e.nativeEvent.offsetX,\n    top: e.nativeEvent.offsetY,\n  };\n}\n\nexport function getElementByType(type) {\n    const Component = ComponentStore[type];\n    if (Component) return Component;\n    return {};\n}\n\nexport function mixinObject (oldObj, newObj) {\n  const result = {...oldObj};\n  Object.keys(newObj).forEach(key => {\n    if(typeof oldObj[key] !== newObj[key]) {\n      throw new Error(`新的对象${key}与原有对象类型不符`);\n    }\n    if(!oldObj[key]) {\n      result[key] = newObj[key]\n    }\n    if (typeof oldObj[key] === 'object' && typeof newObj[key] === 'object') {\n      result[key] = mixinObject(oldObj[key], newObj[key]);\n    }\n    if(typeof oldObj[key] !== 'object' && typeof newObj[key] !== 'object') {\n      result[key] = newObj[key];\n    }\n  })\n  return result;\n}\n\nexport function computePositionByEventAndId(curDom, target) {\n  let left = 0, top = 0;\n  while (curDom.parentNode !== target){\n    if(curDom.offsetLeft){\n      left += curDom.offsetLeft;\n    }\n    if(curDom.offsetTop) {\n      top += curDom.offsetTop;\n    }\n\n    curDom = curDom.parentNode;\n  }\n  return {left, top}\n}\n\nexport function findDOMByEventAndId(e,id) {\n  let element;\n  if (e.target) {\n    element = e.target;\n  } else if (e.parentNode) {\n    element = e.parentNode\n  }\n  if(element.id !== id) {\n    return findDOMByEventAndId(element, id)\n  } else {\n    return element;\n  }\n}\n\nconst pxToPercent = val => `${val * 100}%`;\nconst percentToPx = (val, percent) => {\n  const ratio = percent.match(/\\d+(\\.\\d+)?/g)[0] / 100;\n  return val * ratio;\n}\n/**\n * @description 绝对坐标 -> 相对坐标\n * @param containerPropsStyle 布局盒样式\n * @param innterPropsStyle innterPropsStyle\n * @returns \n */\nexport const absoluteToRealtiveCoordinate = (innterPropsStyle, containerBox) => {\n  if (!innterPropsStyle) {\n    return { top: 0, left: 0, width: 0, height: 0 };\n  }\n  const { top, left, width, height, ...otherStyle } = innterPropsStyle;\n  const result = {\n    left: pxToPercent((left - containerBox.left) / containerBox.width),\n    top: pxToPercent((top - containerBox.top) / containerBox.height),\n    width: pxToPercent((width / containerBox.width)),\n    height:  pxToPercent((height / containerBox.height)),\n    ...otherStyle,\n  };\n  return result;\n};\n\nexport const realtiveToAbsoluteCoordinate = (innterPropsStyle, containerBox) => {\n\n  const { top, left, width, height, ...otherStyle} = innterPropsStyle;\n  const result = {\n    left: Math.ceil(percentToPx(containerBox.width,left) + containerBox.left),\n    top: Math.ceil(percentToPx(containerBox.height, top) + containerBox.top),\n    width: Math.ceil(percentToPx(containerBox.width, width)),\n    height: Math.ceil(percentToPx(containerBox.height, height)),\n    ...otherStyle\n  }\n\n  return  result;\n}\n\nexport const plainDatatoTree = componentMap => {\n  const uuids = Object.keys(componentMap);\n  const copyComponentMap = cloneDeep(componentMap)\n  uuids.forEach(id => {\n    const { parentId } = copyComponentMap[id];\n    if (parentId) {\n      if(copyComponentMap[parentId].children) {\n        copyComponentMap[parentId]['children'][id] = copyComponentMap[id]\n      } else {\n        copyComponentMap[parentId]['children'] = {\n          [id]: copyComponentMap[id]\n        }\n      }\n      delete copyComponentMap[id];\n    }\n  });\n  return copyComponentMap;\n}\n","import * as actionTypes from './actionType';\n\nexport const SAVE = (payload) => ({type: actionTypes.SAVE, payload});\n\nexport const saveRecords = () => ({ type: actionTypes.SAVE_RECORDS });\n\nexport const cancelRecords = (payload) => ({ type: actionTypes.CANCEL_RECORDS , payload});\n\nexport const redoRecords = () => ({\n  type: actionTypes.REDO,\n});\n\nexport const updateCurContainerStyleAction = (payload) => ({\n  type: actionTypes.UPDATE_CURCONTAINER_STYLE,\n  payload,\n});\n\nexport const toggleLockAction = payload => ({\n  type: actionTypes.TOGGLE_LOCK,\n  payload,\n})\n\n","import React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport cloneDeep from \"lodash/cloneDeep\";\nimport { NumberPicker, Button, Range } from \"@ali/wind\";\nimport {\n  changeState,\n  absoluteToRealtiveCoordinate,\n  realtiveToAbsoluteCoordinate,\n} from \"../../utils\";\nimport { v4 as uuid } from \"uuid\";\nimport styles from \"./index.module.scss\";\nimport { \n  cancelRecords,\n  redoRecords,\n  saveRecords,\n  toggleLockAction,\n} from \"../../store/actions\";\nimport record from \"../../store/record\";\nimport { GROUP } from '../../constants';\n\nfunction Header(props) {\n  const {\n    model,\n    changeWidth,\n    changeHeight,\n    changeScale,\n    updateState,\n    addRecords,\n    cancelRecords,\n    redoRecords,\n    toggleLock,\n  } = props;\n  const {\n    containIds,\n    canvasWidth,\n    canvasHeight,\n    scale,\n    areaPos,\n    componentMap,\n    selectComponentId,\n  } = model;\n  const { startPos, endPos } = areaPos;\n  const boxInfo = {\n    left: Math.min(startPos.left, endPos.left),\n    top: Math.min(startPos.top, endPos.top),\n    width: Math.abs(endPos.left - startPos.left),\n    height: Math.abs(endPos.top - startPos.top),\n  };\n\n\n\n  const { isLocked } =  componentMap[selectComponentId] || {};\n  const [speed, setSpeed] = useState<number>(1000);\n\n  const playback = (state, speed) => {\n    const item = state.shift();\n    setTimeout(() => {\n      updateState(item);\n      if (state.length > 0) {\n        playback(state, 1000 / speed);\n      }\n    }, 1000 / speed);\n  };\n\n  const getCombineComponentMap = (parentId) => {\n    return Object.keys(componentMap).reduce((prev, id) => {\n      if (containIds.includes(id)) {\n        return {\n          ...prev,\n          [id]: {\n            ...componentMap[id],\n            containerProps: {\n              ...componentMap[id].containerProps,\n              style: absoluteToRealtiveCoordinate(\n                componentMap[id].containerProps?.style,\n                boxInfo\n              ),\n            },\n            parentId,\n          },\n        };\n      }\n      return { ...prev, [id]: componentMap[id] };\n    }, {});\n  };\n\n  const getSplitComponentMap = (selectId) => {\n    return Object.keys(componentMap).reduce((prev, id) => {\n      const item = componentMap[id];\n      if (item.parentId === selectId) {\n        return {\n          ...prev,\n          [id]: {\n            ...item,\n            parentId: null,\n            containerProps: {\n              ...componentMap[id].containerProps,\n              style: realtiveToAbsoluteCoordinate(\n                componentMap[id].containerProps?.style,\n                componentMap[selectId].containerProps.style\n              ),\n            },\n          },\n        };\n      } else if (selectId !== id) {\n        return {\n          ...prev,\n          [id]: item,\n        };\n      } else {\n        return { ...prev };\n      }\n    }, {});\n  };\n\n  const handleCombine = () => {\n    addRecords();\n    const parentId = uuid();\n    const combineMap = getCombineComponentMap(parentId);\n    const newState = {\n      componentMap: {\n        ...combineMap,\n        [parentId]: {\n          type: GROUP,\n          containerProps: {\n            style: {\n              ...boxInfo,\n            },\n          },\n        },\n      },\n      selectComponentId: parentId,\n      containIds: [],\n      areaPos: {\n        startPos: {\n          left: 0,\n          top: 0,\n        },\n        endPos: {\n          left: 0,\n          top: 0,\n        },\n      },\n    };\n    updateState(newState);\n    addRecords();\n  };\n\n  const handleLock = () => {\n    toggleLock({\n      id: selectComponentId,\n      locked: !isLocked,\n    })\n  }\n\n  const handleSplit = () => {\n    addRecords();\n    const { type } = componentMap[selectComponentId];\n    if (type === GROUP) {\n      const splitMap = getSplitComponentMap(selectComponentId);\n      const newState = {\n        componentMap: { ...splitMap },\n        selectComponentId: \"\",\n        containIds: [],\n        areaPos,\n      };\n      updateState(newState);\n    }\n  };\n\n  const handlePublish = () => {\n    // componentMap\n    // window.localStorage.setItem()\n    JSON.stringify(componentMap)\n  }\n\n  return (\n    <div className={styles.header}>\n      <div\n        style={{\n          display: \"flex\",\n          // flexDirection: \"column\",\n          marginRight: 50,\n        }}\n      >\n          <Range\n            style={{\n              width: 40,\n            }}\n            min={1}\n            max={10}\n            hasTip\n            value={speed}\n            onChange={(val) => setSpeed(Number(val))}\n          />\n        <Button\n          onClick={() => {\n            const records = cloneDeep(record.list);\n            playback(records, speed);\n          }}\n        >\n          回放\n        </Button>\n        </div>\n      宽：\n      <NumberPicker\n        onChange={(val) => changeWidth(val)}\n        className={styles.numberPicker}\n        value={canvasWidth}\n      />\n      高：\n      <NumberPicker\n        onChange={(val) => changeHeight(val)}\n        className={styles.numberPicker}\n        value={canvasHeight}\n      />\n      缩放：\n      <NumberPicker\n        max={500}\n        min={0}\n        onChange={(val) => changeScale(val)}\n        value={scale}\n      />\n      %\n      <div style={{ marginLeft: 16 }}>\n      <Button\n          type=\"secondary\"\n          disabled={!selectComponentId}\n          onClick={handleLock}\n        >\n          { isLocked ? \"解锁\" : \"锁定\" }\n        </Button>\n        <Button\n          type=\"primary\"\n          disabled={containIds.length <= 1}\n          onClick={handleCombine}\n        >\n          组合\n        </Button>\n        <Button\n          type=\"secondary\"\n          disabled={\n            !componentMap[selectComponentId] ||\n            componentMap[selectComponentId].type !== \"group\"\n          }\n          onClick={handleSplit}\n        >\n          拆分\n        </Button>\n        <Button onClick={cancelRecords}>撤销</Button>\n        <Button onClick={redoRecords}>重做</Button>\n        <Button\n          onClick={() =>\n            updateState({\n              ...model,\n              previewVisible: true,\n            })\n          }\n        >\n          预览\n        </Button>\n        <Button\n          onClick={handlePublish}\n        >\n          发布\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default connect(\n  (state) => ({ model: state }),\n  (dispatch) => {\n    return {\n      changeWidth: (val) => dispatch(changeState(\"canvasWidth\", val)),\n      changeHeight: (val) => dispatch(changeState(\"canvasHeight\", val)),\n      changeScale: (val) => dispatch(changeState(\"scale\", val)),\n      updateState: (val) => dispatch(changeState(val)),\n      cancelRecords: (step) => dispatch(cancelRecords(step)),\n      redoRecords: () => dispatch(redoRecords()),\n      addRecords: () => dispatch(saveRecords()),\n      toggleLock: val => dispatch(toggleLockAction(val)),\n    };\n  }\n)(Header);\n","import React from 'react';\nimport ComponentStore from '../../resourceCenter/componentStore';\nimport { connect } from 'react-redux';\nimport styles from './index.module.scss';\nimport { GROUP } from '../../constants';\n\nfunction ComponentPanel(props) {\n  return (\n    <div className={styles.componentList}>\n      {\n      Object.keys(ComponentStore).map(key=> {\n        const component = ComponentStore[key];\n        if (key === GROUP) {\n          return null;\n        }\n        return (\n          <div \n          className={styles.cell} \n          key={key} \n          draggable \n          onDragStart={\n            (e) => e.dataTransfer.setData('type', key)\n          }>\n            <img src={component?.config?.icon} />\n            <br/>\n            <div className={styles.text}>{component?.config?.text}</div>\n          </div>\n        )\n      }\n        \n      )}\n     \n\n    </div>\n  )\n}\n\nexport default connect((state)=>state,()=>({}))(ComponentPanel);","import React from 'react';\n\nexport default function GridLine (props) {\n  const { show } = props;\n\n  if (!show) {\n    return null;\n  }\n\n  return (\n     <svg \n     className=\"grid\" width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">\n        <defs>\n            <pattern id=\"smallGrid\" width=\"7.236328125\" height=\"7.236328125\" patternUnits=\"userSpaceOnUse\">\n                <path \n                    d=\"M 7.236328125 0 L 0 0 0 7.236328125\" \n                    fill=\"none\" \n                    stroke=\"rgba(207, 207, 207, 1)\" \n                    strokeWidth=\"1\">\n                </path>\n            </pattern>\n            <pattern id=\"grid\" width=\"36.181640625\" height=\"36.181640625\" patternUnits=\"userSpaceOnUse\">\n                <rect width=\"36.181640625\" height=\"36.181640625\" fill=\"url(#smallGrid)\"></rect>\n                <path \n                    d=\"M 36.181640625 0 L 0 0 0 36.181640625\" \n                    fill=\"none\" \n                    stroke=\"rgba(186, 186, 186, 0.5)\" \n                    strokeWidth=\"1\">\n                </path>\n            </pattern>\n        </defs>\n        <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\"></rect>\n    </svg>\n  )\n}","import React from 'react';\n\nimport { getClientPosByEvent } from '../../../../../utils';\nimport record from '../../../../../store/record';\n\nimport styles from './index.module.scss';\n\nfunction Circle(props): React.ReactElement {\n  const {\n    position,\n    style,\n    addRecord,\n  } = props;\n  \n  const handleMouseDown = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    const {\n      x: startX,\n      y: startY,\n    } = getClientPosByEvent(e);\n    const move:(e: MouseEvent)=>void = moveEvent => {\n      const {\n        x: curX,\n        y: curY,\n      } = getClientPosByEvent(moveEvent);\n      const distanceX = curX - startX;\n      const distanceY = curY - startY;\n\n      props.updateComponentItemByPos(position, { distanceX, distanceY });\n    };\n\n    const up = () => {\n      addRecord();\n      document.removeEventListener('mousemove', move);\n      document.removeEventListener('mouseup', up);\n    };\n\n    document.addEventListener('mousemove', move);\n    document.addEventListener('mouseup', up);\n  };\n\n  return (\n    <div\n      role=\"button\"\n      tabIndex={0}\n      onMouseDown={handleMouseDown}\n      style={style}\n      className={styles.circle} />\n  );\n}\n\nexport default Circle;\n","import React from 'react';\n\nconst Rotate = props => {\n  return (\n    <div {...props}>\n      <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path\n          d=\"M10.536 3.464A5 5 0 1 0 11 10l1.424 1.425a7 7 0 1 1-.475-9.374L13.659.34A.2.2 0 0 1 14 .483V5.5a.5.5 0 0 1-.5.5H8.483a.2.2 0 0 1-.142-.341l2.195-2.195z\"\n          fill=\"#eb5648\"\n          fillRule=\"nonzero\" />\n      </svg>\n    </div>\n  );\n};\n\nexport default Rotate;","\nimport { CirclePos } from '../../../../types';\n\nexport const circleProps: { position: CirclePos; style: object }[] = [\n  {\n    position: \"lt\",\n    style: {\n      cursor: \"nwse-resize\",\n      left: -4,\n      top: -4,\n    },\n  },\n  {\n    position: \"t\",\n    style: {\n      cursor: \"ns-resize\",\n      left: \"50%\",\n      marginLeft: -4,\n      top: -4,\n    },\n  },\n  {\n    position: \"rt\",\n    style: {\n      right: -4,\n      top: -4,\n      cursor: \"nesw-resize\",\n    },\n  },\n  {\n    position: \"l\",\n    style: {\n      cursor: \"w-resize\",\n      left: -4,\n      top: \"50%\",\n      marginTop: -4,\n    },\n  },\n  {\n    position: \"r\",\n    style: {\n      right: -4,\n      top: \"50%\",\n      marginTop: -4,\n      cursor: \"e-resize\",\n    },\n  },\n  {\n    position: \"lb\",\n    style: {\n      cursor: \"nesw-resize\",\n      bottom: -4,\n      left: -4,\n    },\n  },\n  {\n    position: \"b\",\n    style: {\n      cursor: \"ns-resize\",\n      left: \"50%\",\n      marginLeft: -4,\n      bottom: -4,\n    },\n  },\n  {\n    position: \"br\",\n    style: {\n      cursor: \"nwse-resize\",\n      bottom: -4,\n      right: -4,\n    },\n  },\n];","\nimport React, { useRef } from 'react';\nimport { connect } from 'react-redux';\nimport cls from 'classnames';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Icon } from '@ali/wind';\n\nimport { changeState, getClientPosByEvent } from '../../../../utils';\nimport { CirclePos } from '../../../../types';\nimport {\n  saveRecords,\n  updateCurContainerStyleAction,\n} from '../../../../store/actions';\n\nimport Circle from './Circle';\nimport Rotate from './Rotate';\nimport { circleProps } from './constants';\nimport styles from './index.module.scss';\n\nconst updateComponentMapOrder = (id, componentMap): any => {\n  const copyObj = cloneDeep(componentMap);\n\n  delete copyObj[id];\n  copyObj[id] = componentMap[id];\n\n  return copyObj;\n};\n\nconst ResizeWrapper: React.FC<any> = props => {\n  const {\n    containerProps,\n    model,\n    index,\n    style,\n    className,\n    id,\n    updateCurContainerStyle,\n    updateSelectComponentAndOrderMap,\n    addRecord,\n  } = props;\n\n  const { componentMap, selectComponentId } = model;\n\n  const wrapper = useRef<any>({});\n  const { offsetWidth, offsetHeight, offsetLeft, offsetTop } = wrapper.current;\n  const isSelected = id && id === selectComponentId;\n  const { isLocked } = componentMap[id];\n  const updateComponentItemByPos = (position: CirclePos, updateProps) => {\n    const { distanceX = 0, distanceY = 0 } = updateProps;\n    const newPropsByPos = {\n      lt: {\n        width: Math.round(offsetWidth - distanceX),\n        height: Math.round(offsetHeight - distanceY),\n        left: Math.round(offsetLeft + distanceX),\n        top: Math.round(offsetTop + distanceY),\n      },\n      rt: {\n        width: Math.round(offsetWidth + distanceX),\n        height: Math.round(offsetHeight - distanceY),\n        top: Math.round(offsetTop + distanceY),\n      },\n      lb: {\n        width: Math.round(offsetWidth - distanceX),\n        height: Math.round(offsetHeight + distanceY),\n        left: Math.round(offsetLeft + distanceX),\n      },\n      br: {\n        width: Math.round(offsetWidth + distanceX),\n        height: Math.round(offsetHeight + distanceY),\n      },\n      t: {\n        height: Math.round(offsetHeight - distanceY),\n        top: Math.round(offsetTop + distanceY),\n      },\n      l: {\n        width: Math.round(offsetWidth - distanceX),\n        left: Math.round(offsetLeft + distanceX),\n      },\n      r: {\n        width: Math.round(offsetWidth + distanceX),\n      },\n\n      b: {\n        height: Math.round(offsetHeight + distanceY),\n      },\n    };\n\n    updateCurContainerStyle({\n      ...newPropsByPos[position],\n    });\n  };\n  const { top, left, width, height, rotate = 0 } = containerProps.style;\n  const centerX = left + width / 2 + 200;\n  const centerY = top + height / 2 + 56;\n  const handleRotate = e => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const startRotate =\n      (180 / Math.PI) * Math.atan2(e.clientY - centerY, e.clientX - centerX);\n\n    const move = moveEvent => {\n      const endRotate =\n        (180 / Math.PI) *\n        Math.atan2(moveEvent.clientY - centerY, moveEvent.clientX - centerX);\n\n      updateCurContainerStyle({\n        rotate: Math.round(endRotate - startRotate + rotate),\n      });\n    };\n    const up = () => {\n      document.removeEventListener('mousemove', move);\n      document.removeEventListener('mouseup', up);\n    };\n\n    document.addEventListener('mousemove', move);\n    document.addEventListener('mouseup', up);\n  };\n\n  const handleMouseDown = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    const orderMap = updateComponentMapOrder(id, componentMap);\n    const { x: startX, y: startY } = getClientPosByEvent(e);\n    const left = e.currentTarget.offsetLeft;\n    const top = e.currentTarget.offsetTop;\n\n    updateSelectComponentAndOrderMap(id, orderMap);\n\n    const move = moveEvent => {\n      if (isLocked) {\n        return;\n      }\n\n      const { x: curX, y: curY } = getClientPosByEvent(moveEvent);\n      const curLeft = curX - startX + left;\n      const curTop = curY - startY + top;\n\n      updateCurContainerStyle({\n        left: curLeft,\n        top: curTop,\n      });\n    };\n\n    const up = () => {\n      addRecord();\n      document.removeEventListener('mousemove', move);\n      document.removeEventListener('mouseup', up);\n    };\n\n    document.addEventListener('mousemove', move);\n    document.addEventListener('mouseup', up);\n  };\n\n  return (\n    <div\n      tabIndex={0}\n      role=\"button\"\n      ref={wrapper}\n      key={id}\n      className={cls({\n        [className]: className,\n        [styles.selected]: isSelected,\n      })}\n      style={{\n        position: 'absolute',\n        cursor: 'move',\n        ...style,\n        zIndex: index,\n        ...containerProps.style,\n        transform: `rotate(${containerProps.style.rotate}deg)`,\n      }}\n      onMouseDown={handleMouseDown}\n      onDragOver={e => e.preventDefault()}>\n      {isSelected && !isLocked && (\n        <>\n          <Rotate onMouseDown={handleRotate} className={styles.rotate} />\n          {circleProps.map(circleProp => {\n            return (\n              <Circle\n                addRecord={addRecord}\n                updateComponentItemByPos={updateComponentItemByPos}\n                key={circleProp.position}\n                {...circleProp} />\n            );\n          })}\n        </>\n      )}\n      {isLocked && (\n        <div className={styles.locked}>\n          <Icon size=\"xs\" type=\"lock-fill\" />\n        </div>\n      )}\n      {props.children}\n    </div>\n  );\n};\n\nexport default connect(\n    state => ({\n      model: state,\n    }),\n    dispatch => ({\n      updateCurContainerStyle: val =>\n        dispatch(updateCurContainerStyleAction(val)),\n      updateSelectComponentAndOrderMap: (selectComponentId, componentMap) =>\n        dispatch(\n            changeState({\n              selectComponentId,\n              componentMap,\n            })\n        ),\n      addRecord: () => dispatch(saveRecords()),\n    })\n)(ResizeWrapper);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { getElementByType } from '../../../utils';\nimport { GROUP } from '../../../constants';\n\nimport ResizeWrapper from './ResizeWrapper';\n\n/**\n * \n *   合模式下： 顶层group 中间层group，底层component\n  //    顶层group：无parentId，type类型是group，\n  //    中间层group： 有parentId，type是group 有children\n  //    底层Component： 有parentId， 无children\n */\n\nfunction Element(props): React.ReactElement {\n  const {\n    id,\n    index,\n    style,\n    item: { type, componentProps, containerProps, parentId },\n    children,\n  } = props;\n\n  const Component = getElementByType(type);\n  // 独立模式下的Component渲染\n\n  if (!containerProps) {\n    return null;\n  }\n\n  if (!parentId && !children) {\n    return (\n      <ResizeWrapper\n        index={index}\n        containerProps={containerProps}\n        id={id}>\n        <Component {...componentProps} />\n      </ResizeWrapper>\n    );\n  }\n\n  // 组合模式下顶层Group渲染\n\n  if (!parentId && type === GROUP) {\n    return (\n      <ResizeWrapper\n        index={index}\n        containerProps={containerProps}\n        id={id}>\n        <Component\n          {...componentProps}>\n          {children}\n          \n        </Component>\n      </ResizeWrapper>\n    );\n  }\n\n  // 组合模式下 中间层group渲染\n\n  if (parentId && type === GROUP && children && children.length > 0) {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          cursor: 'move',\n          ...containerProps.style,\n          transform: `rotate(${containerProps.style.rotate}deg)`\n        }}>\n        {children}\n      </div>\n    );\n  }\n\n  // 组合模式下，内含的Component渲染\n  if (parentId && !children) {\n\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          cursor: 'move',\n          ...style,\n          ...containerProps.style,\n          transform: `rotate(${containerProps.style.rotate}deg)`\n        }}>\n        <Component {...componentProps} />\n      </div>\n    );\n  }\n}\n\nexport default connect(state => state)(Element);\n","import React, { useState, useEffect } from \"react\";\nimport cls from \"classnames\";\nimport useDeepCompareEffect from 'use-deep-compare-effect';\nimport { connect } from \"react-redux\";\nimport styles from \"./index.module.scss\";\nimport {\n  updateCurContainerStyleAction,\n} from '../../../store/actions'\n\nconst diff: number = 4;\nconst initlineArr = [\n  {\n    type: \"xt\",\n    show: false,\n    left: 0,\n    top: 0,\n  },\n  {\n    type: \"xc\",\n    show: false,\n    left: 0,\n    top: 0,\n  },\n  {\n    type: \"xb\",\n    show: false,\n    left: 0,\n    top: 0,\n  },\n  {\n    type: \"yl\",\n    show: false,\n    left: 0,\n    top: 0,\n  },\n  {\n    type: \"yc\",\n    show: false,\n    left: 0,\n    top: 0,\n  },\n  {\n    type: \"yr\",\n    show: false,\n    left: 0,\n    top: 0,\n  },\n];\n\nfunction MarkLine(props) {\n  \n  const [lineArr, setLineArr] = useState(initlineArr);\n  const { \n    componentMap, \n    selectComponentId, \n    updateCurContainerStyle,\n  } = props;\n\n  const isNearly = (dragVal, targetVal): boolean => {\n    return Math.abs(dragVal - targetVal) <= diff;\n  }\n    \n\n  const getCurrentComponentsPosition = () => {\n    const currentComponent = componentMap[selectComponentId] || {};\n    const { containerProps } = currentComponent || {};\n    const { style } = containerProps || {};\n    const { top: curTop, left: curLeft, width, height } = style || {};\n    const curBottom = curTop + height;\n    const curRight = curLeft + width;\n\n    return {\n      curTop,\n      curLeft,\n      curBottom,\n      curRight,\n      curWidth: width,\n      curHeight: height,\n    };\n  };\n\n  const updateLineArr = ({ type, left, top, show = true }) => {\n    setLineArr((prev) => {\n      return prev.map((item) => {\n        if (item.type === type) {\n          return {\n            ...item,\n            show,\n            top,\n            left,\n          };\n        }\n        return item;\n      });\n    });\n  };\n\n  const {\n    curTop,\n    curLeft,\n    curBottom,\n    curRight,\n    curWidth,\n    curHeight,\n  } = getCurrentComponentsPosition();\n\n  const hideLine = () => {\n    setLineArr(initlineArr);\n  };\n\n  useDeepCompareEffect(() => {\n    Object.keys(componentMap).forEach((id) => {\n      const { containerProps } = componentMap[id];\n      // 当前组件被组合组件包括，或者选中的组件是当前组件不显示markline\n      if (id === selectComponentId || componentMap[id]['parentId']) return;\n      const { top, left, width, height } = containerProps.style;\n      const right = left + width;\n      const bottom = top + height;\n      const centerPos = { left: left + width / 2, top: top + height / 2 };\n      const curCenterPos = {\n        left: curLeft + curWidth / 2,\n        top: curTop + curTop / 2,\n      };\n\n\n\n      if (isNearly(curCenterPos.top, centerPos.top)) {\n        updateLineArr({\n          type: \"xc\",\n          top: centerPos.top,\n          left: 0,\n        });\n        updateCurContainerStyle({\n          top: top - (curHeight - height) / 2,\n          left: curLeft,\n        });\n      }\n\n      if (isNearly(curCenterPos.left, centerPos.left)) {\n        updateLineArr({\n          type: \"yc\",\n          top: 0,\n          left: centerPos.left,\n        });\n\n        updateCurContainerStyle({\n          top: curTop,\n          left: left - (curWidth - width) / 2,\n        });\n      }\n\n      if (isNearly(curCenterPos.left, centerPos.left)) {\n        updateLineArr({\n          type: \"yc\",\n          left: curCenterPos.left,\n          top: 0,\n        });\n      }\n      // 两个盒子top接近时\n      if (isNearly(curTop, top) || isNearly(curBottom, top)) {\n        updateLineArr({\n          type: \"xt\",\n          top,\n          left: 0,\n        });\n\n        if (isNearly(curTop, top)) {\n          updateCurContainerStyle({\n            top,\n            left: curLeft,\n          });\n        }\n\n        if (isNearly(curBottom, top)) {\n          updateCurContainerStyle({\n            top: top - curHeight,\n            left: curLeft,\n          });\n        }\n      }\n\n      if (isNearly(curLeft, left) || isNearly(curRight, left)) {\n        updateLineArr({\n          type: \"yl\",\n          left,\n          top: 0,\n        });\n\n        if (isNearly(curLeft, left)) {\n          updateCurContainerStyle({\n            left,\n            top: curTop,\n          });\n        }\n\n        if (isNearly(curRight, left)) {\n          updateCurContainerStyle({\n            left: left - curWidth,\n            top: curTop,\n          });\n        }\n      }\n      // 当right接近时 ||  当dragElement left接近 element右边时\n      if (isNearly(curRight, right) || isNearly(curLeft, right)) {\n        updateLineArr({\n          type: \"yr\",\n          left: right,\n          top: 0,\n        });\n\n        if (isNearly(curRight, right)) {\n          updateCurContainerStyle({\n            left: right - curWidth,\n            top: curTop,\n          });\n        }\n\n        if (isNearly(curLeft, right)) {\n          updateCurContainerStyle({\n            left: right,\n            top: curTop,\n          });\n        }\n      }\n\n      if (isNearly(curBottom, bottom) || isNearly(curTop, bottom)) {\n        updateLineArr({\n          type: \"xb\",\n          left: 0,\n          top: bottom,\n        });\n\n        if (isNearly(curBottom, bottom)) {\n          updateCurContainerStyle({\n            left: curLeft,\n            top: top + height - curHeight,\n          });\n        }\n\n        if (isNearly(curTop, bottom)) {\n          updateCurContainerStyle({\n            left: curLeft,\n            top: height + top,\n          });\n        }\n      }\n    });\n  }, [curBottom, curTop, curLeft, curRight, componentMap]);\n\n  useEffect(() => {\n    document.addEventListener(\"mouseup\", hideLine);\n    return () => {\n      document.removeEventListener(\"mouseup\", hideLine);\n    };\n  }, []);\n\n  return (\n    <div className={styles.markline}>\n      {lineArr.map(({ left, top, show, type }) => (\n        <div\n          style={{\n            left,\n            top,\n          }}\n          key={type}\n          className={cls({\n            [styles.hide]: !show,\n            [styles.hor]: type.includes(\"x\"),\n            [styles.ver]: type.includes(\"y\"),\n            [styles.line]: true,\n          })}\n        />\n      ))}\n    </div>\n  );\n}\n\nexport default connect(\n  (state) => state,\n  (dispatch) => ({\n    updateCurContainerStyle: (val) =>\n      dispatch(updateCurContainerStyleAction(val)),\n  })\n)(MarkLine);\n","import React from 'react';\nimport { connect } from 'react-redux';\n// import ResizeWrapper from \"../ResizeWrapper\";\n// import { IArea } from \"../../../interface\";\n\nfunction Area(props) {\n  const {\n    areaPos: {\n      startPos,\n      endPos,\n    },\n    // containerProps,\n    // selectComponentId,\n    // updateSelectComponent, \n  } = props;\n  const width = Math.abs(endPos.left - startPos.left);\n  const height = Math.abs(endPos.top - startPos.top);\n  const boxLeft = endPos.left > startPos.left ? startPos.left : endPos.left;\n  const boxTop = endPos.top > startPos.top ? startPos.top : endPos.top;\n  \n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        zIndex: 999999,\n        position: 'absolute',\n        width,\n        height,\n        left: boxLeft,\n        top: boxTop,\n        border: '1px solid #409eff',\n      }} />\n  );\n}\n\nexport default connect(state => state)(Area);\n","\n/**\n     * 旋转公式：\n     *  点a(x, y)\n     *  旋转中心c(x, y)\n     *  旋转后点n(x, y)\n     *  旋转角度θ                tan ??\n     * nx = cosθ * (ax - cx) - sinθ * (ay - cy) + cx\n     * ny = sinθ * (ax - cx) + cosθ * (ay - cy) + cy\n     */\n\n// const centerX = left + width / 2;\n// const centerY = top + height / 2;\n\n// left = Math.cos(rotate) * (left - centerX) - Math.sin(rotate) * (top - centerY) + centerX;\n// top = Math.sin(rotate) * (left - centerX) + Math.cos(rotate) * (top - centerY) + centerY;\n// console.log(left, top, rotate);\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useState } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { connect } from 'react-redux';\nimport cloneDeep from 'lodash/cloneDeep';\nimport curry from 'lodash/curry';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\n\nimport { plainDatatoTree,\n  changeState,\n  getElementPosByEvent,\n  getElementByType,\n} from '../../utils';\nimport { IArea } from '../../interface';\nimport {\n  cancelRecords,\n  redoRecords,\n  saveRecords,\n} from '../../store/actions';\nimport { GROUP } from '../../constants';\n\nimport GridLine from './GridLine';\nimport styles from './index.module.scss';\nimport Element from './Element';\nimport MarkLine from './MarkLine';\nimport Area from './Area';\n\nfunction Editor(props) {\n  const [showGridLine, toggleGridLine] = useState(true);\n  const {\n    model,\n    updateComponentMap,\n    updateComponentMapAndSelectId,\n    updateSelectComponent,\n    updateAreaPos,\n    addRecords,\n    cancelRecords,\n    redoRecords,\n  } = props;\n\n  const {\n    canvasWidth,\n    canvasHeight,\n    scale: scaleRatio,\n    componentMap,\n    selectComponentId,\n  } = model;\n\n  const initialAreaPos = {\n    startPos: {\n      left: 0,\n      top: 0,\n    },\n    endPos: {\n      left: 0,\n      top: 0,\n    }\n  };\n  const hideArea = () => {\n    updateAreaPos(initialAreaPos, []);\n  };\n\n  const findChildrenIdBySelectId = selectedId => {\n    return Object.keys(componentMap).filter(id => {\n      return componentMap[id].parentId === selectedId;\n    });\n  };\n\n  const deleteElement = (parentId, copyState) => {\n    const { type } = copyState[parentId];\n\n    if (type === GROUP) {\n      const childs = findChildrenIdBySelectId(parentId);\n\n      childs.forEach(id => {\n        deleteElement(id, copyState);\n      });\n    }\n\n    delete copyState[parentId];\n  };\n\n  const handleKey = key => {\n    const keyHandleMap = {\n      backspace: () => {\n        const copyState = cloneDeep(componentMap);\n\n        deleteElement(selectComponentId, copyState);\n        // 清除selectedId和更新componentMap属性\n        updateComponentMapAndSelectId(copyState, null);\n      },\n      'cmd+h': () => {\n        toggleGridLine(!showGridLine);\n      },\n      'cmd+z': () => {\n        // 撤销\n        cancelRecords();\n      },\n      'cmd+shift+z': () => {\n        // 重做\n        redoRecords();\n      }\n    };\n\n    keyHandleMap[key]();\n  };\n\n  const angleToRadian = angle => angle * Math.PI / 180;\n  \n  function calculateRotatedPointCoordinate(center, rotate, point) {\n    /**\n     * 旋转公式：\n     *  点a(x, y)\n     *  旋转中心c(x, y)\n     *  旋转后点n(x, y)\n     *  旋转角度θ                tan ??\n     * nx = cosθ * (ax - cx) - sinθ * (ay - cy) + cx\n     * ny = sinθ * (ax - cx) + cosθ * (ay - cy) + cy\n     */\n\n    return {\n      x: (point.x - center.x) * Math.cos(angleToRadian(rotate)) - (point.y - center.y) * Math.sin(angleToRadian(rotate)) + center.x,\n      y: (point.x - center.x) * Math.sin(angleToRadian(rotate)) + (point.y - center.y) * Math.cos(angleToRadian(rotate)) + center.y,\n    };\n  }\n\n  /**\n  * @description 计算组合最小包围盒子\n  * @param containIds \n  * @returns IArea\n  */\n  const getMinWrapperAreaPos = (containIds: string[]) => {\n    let startLeft = Number.MAX_SAFE_INTEGER;\n    let endLeft = -Number.MAX_SAFE_INTEGER;\n    let startTop = Number.MAX_SAFE_INTEGER;\n    let endTop = -Number.MAX_SAFE_INTEGER;\n\n    containIds.forEach(id => {\n      const { width, height, rotate = 0 } = componentMap[id].containerProps.style;\n      const { left, top } = componentMap[id].containerProps.style;\n      const centerX = left + width / 2;\n      const centerY = top + height / 2;\n      const getRotatePointByPoint = curry(calculateRotatedPointCoordinate)({\n        x: centerX,\n        y: centerY,\n      })(rotate);\n\n      // 获取左上角旋转点坐标\n      const { x: leftTopX, y: leftTopY } = getRotatePointByPoint({\n        x: left,\n        y: top,\n      });\n      // 右上角\n      const { x: rightTopX, y: rightTopY } = getRotatePointByPoint({\n        x: left + width,\n        y: top,\n      });\n      // 左下角\n      const { x: leftBottomX, y: leftBottomY } = getRotatePointByPoint({\n        x: left,\n        y: top + height,\n      });\n      // 右下角\n      const { x: rightBottomX, y: rightBottomY } = getRotatePointByPoint({\n        x: left + width,\n        y: top + height,\n      });\n      const maxX = Math.max.call(null, leftTopX, rightTopX, leftBottomX, rightBottomX);\n      const minX = Math.min.call(null, leftTopX, rightTopX, leftBottomX, rightBottomX);\n      const maxY = Math.max.call(null, leftTopY, rightTopY, leftBottomY, rightBottomY);\n      const minY = Math.min.call(null, leftTopY, rightTopY, leftBottomY, rightBottomY);\n\n      if (minX < startLeft) {\n        startLeft = left;\n      }\n\n      if (endLeft < maxX) {\n        endLeft = maxX;\n      }\n\n      if (minY < startTop) {\n        startTop = minY;\n      }\n\n      if (endTop < maxY) {\n        endTop = maxY;\n      }\n    });\n    \n    const areaPos = {\n      startPos: {\n        left: startLeft,\n        top: startTop,\n      },\n      endPos: {\n        left: endLeft,\n        top: endTop,\n      }\n    };\n\n    return areaPos;\n  };\n\n  const handleMouseDown = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    updateSelectComponent(null);\n\n    const dom = document.querySelector('#editorWrapper');\n    const { left, top } = dom.getBoundingClientRect();\n    const startPos = getElementPosByEvent(e); // 不要在move里执行，否则要加e.presist();\n    let areaPos: IArea = initialAreaPos;\n\n    const move = moveEvent => {\n      areaPos = {\n        startPos,\n        endPos: {\n          left: moveEvent.clientX - left,\n          top: moveEvent.clientY - top,\n        },\n      };\n      updateAreaPos(areaPos, []);\n    };\n    \n    const up = () => {\n      // 计算盒子\n      const containIds: string[] = [];\n\n      Object.keys(componentMap).forEach(id => {\n        const { endPos } = areaPos;\n        const boxInfo = {\n          left: Math.min(startPos.left, endPos.left),\n          top: Math.min(startPos.top, endPos.top),\n          width: Math.abs(endPos.left - startPos.left),\n          height: Math.abs(endPos.top - startPos.top),\n        };\n        const componentinfo = componentMap[id];\n        const {\n          containerProps: {\n            style: {\n              left,\n              top,\n              width,\n              height,\n              rotate = 0,\n            }\n          }\n        } = componentinfo;\n\n        if (\n          boxInfo.left < left &&\n            boxInfo.top < top &&\n            boxInfo.width + boxInfo.left > left + width &&\n            boxInfo.height + boxInfo.top > height + top\n            && !componentinfo.isLocked\n        ) {\n          containIds.push(id);\n        }\n      });\n\n      if (containIds.length > 1) {\n        const minWrapperPos = getMinWrapperAreaPos(containIds);\n\n        updateAreaPos(minWrapperPos, containIds);\n      } else {\n        hideArea();\n      }\n\n      document.removeEventListener('mousemove', move);\n      document.removeEventListener('mouseup', up);\n    };\n\n    document.addEventListener('mousemove', move);\n    document.addEventListener('mouseup', up);\n  };\n\n  const handleDrop = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { left, top } = getElementPosByEvent(e);\n    const type = e.dataTransfer.getData('type');\n\n    if (type) {\n      const { initialProps } = getElementByType(type);\n      const {\n        top: initialTop,\n        left: initialLeft,\n        right: initialRight,\n        bottom: initialBottom,\n        width,\n        height, ...componentProps\n      } = initialProps || {};\n      const containerProps = {\n        style: {\n          top,\n          left,\n          width,\n          height,\n        }\n      };\n      const updatedMap = {\n        ...componentMap,\n        [uuid()]: {\n          type,\n          containerProps,\n          componentProps,\n        }\n      };\n\n      updateComponentMap(updatedMap);\n      addRecords();\n    }\n  };\n\n  const renderElement = data => {\n    if (!data) { return null; }\n\n    return Object.keys(data).map((uid, index) => {\n      const item = data[uid];\n\n      return (\n        <Element\n          id={uid}\n          key={uid}\n          item={item}\n          index={index}>\n          {renderElement(item.children)}\n        </Element>\n      );\n    });\n  };\n  const transferData = plainDatatoTree(componentMap);\n\n  return (\n    <div\n      id=\"editorWrapper\"\n      className={styles.editor}\n      style={{\n        width: canvasWidth,\n        height: canvasHeight,\n        transformOrigin: '0 0',\n        transform: `scale(${scaleRatio / 100})`\n      }}>\n      <KeyboardEventHandler\n        handleKeys={['backspace', 'cmd+h', 'cmd+z', 'cmd+shift+z']}\n        onKeyEvent={handleKey} />\n      <div\n        onMouseDown={handleMouseDown}\n        style={{ position: 'absolute', width: '100%', height: '100%' }}\n        onDragOver={e => e.preventDefault()}\n        onDrop={handleDrop}>\n        <GridLine show={showGridLine} />\n        {\n          renderElement(transferData)\n        }\n      </div>\n      {showGridLine && <MarkLine />}\n      <Area />\n    </div>\n  );\n}\n\nexport default connect(\n    state => ({ model: state }),\n    dispatch => ({\n      updateComponentMap: val => dispatch(changeState('componentMap', val)),\n      updateSelectComponent: selectId => dispatch(changeState('selectComponentId', selectId)),\n      updateAreaPos: (position, containIds) => dispatch(changeState({ areaPos: position, containIds })),\n      updateComponentMapAndSelectId: (val, selectId) => {\n        dispatch(changeState({ componentMap: val, selectComponentId: selectId }));\n      },\n      addRecords: () => dispatch(saveRecords()),\n      cancelRecords: step => dispatch(cancelRecords(step)),\n      redoRecords: () => dispatch(redoRecords()),\n    })\n)(Editor);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport styles from './index.module.scss';\n\nfunction AttributePanel(props):React.ReactElement {\n  const { selectComponentId, componentMap } = props;\n  const {\n    containerProps,\n    componentProps,\n  } = componentMap[selectComponentId] || {};\n\n  return (\n    selectComponentId &&\n    <div className={styles.attributePanel}>\n      x: {containerProps.style.left}\n      y: {containerProps.style.top}\n      width: {containerProps.style.width}\n      height: {containerProps.style.height}\n      rotate: {containerProps.style.rotate}\n      {/* <Input.TextArea\n        rows={20}\n        value={JSON.stringify(containerProps)} \n        // onChange= {handleChange}\n      /> */}\n    </div>\n  );\n}\n\nexport default connect(state => state, dispatch => ({\n\n}))(AttributePanel);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { Dialog } from '@ali/wind';\n\nimport { GROUP } from '../../constants';\nimport { changeState, plainDatatoTree, getElementByType } from '../../utils';\n\nfunction Preview(props) {\n  const {\n    model,\n    updateState,\n  } = props;\n\n  const {\n    previewVisible,\n    canvasWidth,\n    canvasHeight,\n    componentMap,\n  } = model;\n\n  if (!previewVisible) {\n    return null;\n  }\n\n  const transferData = plainDatatoTree(componentMap);\n\n  const renderElement: (transferData: any) => any = data => {\n    if (!data) {\n      return null;\n    }\n\n    return Object.keys(data).map(id => {\n      const { type, containerProps, componentProps, children } = data[\n          id\n      ];\n      const Component = getElementByType(type);\n\n      const renderComponent = () => {\n        // group渲染\n        if (type === GROUP) {\n          return renderElement(children);\n        }\n\n        // 独立component渲染\n        if (type !== GROUP) {\n          return (\n            <Component\n              {...componentProps} />\n          );\n        }\n\n        return null;\n      };\n\n      return (\n        <div\n          key={id}\n          style={{\n            position: 'absolute',\n            ...containerProps.style,\n            transform: `rotate(${containerProps.style.rotate}deg)`\n          }}>\n          {renderComponent()}\n        </div>\n      );\n    });\n  };\n\n  const closeDialog = () =>\n    updateState({\n      ...model,\n      previewVisible: false,\n    });\n\n  return (\n    <Dialog\n      visible={previewVisible}\n      title=\"预览\"\n      onClose={closeDialog\n      }\n      onCancel={closeDialog}\n      onOk={closeDialog}>\n      <div\n        style={{\n          position: 'relative',\n          width: canvasWidth,\n          height: canvasHeight,\n        }}>\n        {renderElement(transferData)}\n      </div>\n    </Dialog>\n  );\n}\n\nexport default connect(\n    state => ({\n      model: state,\n    }),\n    dispatch => ({\n      updateState: val => dispatch(changeState(val)),\n    })\n)(Preview);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Stats from 'stats-js';\nimport store from './store';\nimport {Provider} from 'react-redux';\nimport Header from './views/Header';\nimport ComponentList from './views/ComponentPanel';\nimport Editor from './views/Editor';\nimport AttributePanel from './views/AttributePanel';\nimport Preview from './views/Preview';\nimport styles from './index.module.css';\nimport '@ali/wind/dist/wind.min.css';\n\nconst Parent = () => {\n\n  return (\n    <div className={styles.container}>\n      <Header></Header>\n      <div className={styles.content}>\n        <ComponentList />\n        <div className={styles.editor}>\n          <Editor />\n        </div>\n        <AttributePanel />\n        <Preview />\n      </div>\n    </div>\n  )\n}\n\n\nReactDOM.render(\n  <Provider store={store}>\n    <Parent />\n  </Provider>\n, document.getElementById(\"root\"));\n\nconst stats = new Stats();\nstats.showPanel( 0 ); // 0: fps, 1: ms, 2: mb, 3+: custom\ndocument.body.appendChild( stats.dom );\n\nfunction animate() {\n \n    stats.begin();\n \n    stats.end();\n \n    requestAnimationFrame( animate );\n \n}\n \nrequestAnimationFrame( animate );","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__nGceP\",\"numberPicker\":\"Header_numberPicker__1Eeju\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"componentList\":\"ComponentPanel_componentList__1-9lm\",\"cell\":\"ComponentPanel_cell__3jcko\",\"text\":\"ComponentPanel_text__3d8cg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"selected\":\"ResizeWrapper_selected__3URnW\",\"locked\":\"ResizeWrapper_locked__1V3Aj\",\"rotate\":\"ResizeWrapper_rotate__R6YHL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"src_container__12MZc\",\"content\":\"src_content__110zU\",\"editor\":\"src_editor__1vpBc\"};"],"sourceRoot":""}